■c(0,4,4,-2,-2,0,2,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-3,0,0,0,0,-3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0)

■thePoition

> Date   ExpDate TYPE Strike        ContactName Position      Price        Delta       Gamma       Vega       Theta         Rho
1  2015/1/9 2015/2/20    1    820 RUT150220P00820000        4  0.2000000 -0.003710656 0.000065900 0.03662533 -0.03266815 -0.03266815
2  2015/1/9 2015/2/20    1    840 RUT150220P00840000        4  0.2750000 -0.005087681 0.000089700 0.04856003 -0.04219011 -0.04219011
3  2015/1/9 2015/2/20    1    850 RUT150220P00850000       -2  0.3249999 -0.005991057 0.000104934 0.05614916 -0.04819170 -0.04819170
4  2015/1/9 2015/2/20    1    860 RUT150220P00860000       -2  0.3750000 -0.006918843 0.000120983 0.06377758 -0.05392035 -0.05392035
5  2015/1/9 2015/2/20    1    880 RUT150220P00880000        2  0.4750000 -0.008868777 0.000156137 0.07934660 -0.06464948 -0.06464948
6  2015/1/9 2015/2/20    1    890 RUT150220P00890000        4  0.5250000 -0.009900964 0.000175607 0.08736828 -0.06968009 -0.06968009
7  2015/1/9 2015/2/20    1    900 RUT150220P00900000        3  0.6249984 -0.011706290 0.000205537 0.10108410 -0.07967925 -0.07967925
8  2015/1/9 2015/2/20    1   1090 RUT150220P01090000       -3  8.5500000 -0.153385800 0.002300145 0.78250980 -0.42358380 -0.42358380
9  2015/1/9 2015/2/20    1   1140 RUT150220P01140000       -3 17.4000000 -0.289503800 0.003715181 1.13098900 -0.54470340 -0.54470340
10 2015/1/9 2015/2/20    1   1180 RUT150220P01180000        3 29.9500200 -0.454407400 0.004756227 1.31056000 -0.56609560 -0.56609560
> OrigIV    UDLY  IVIDX  HowfarOOM TimeToExpDate     ATMIV Moneyness.Nm　　IV理論値
1  0.5083858 1185.68 0.2129 0.30841370      1.333333 0.2520018  -1.26730000　　0.5596092 過小評価
2  0.4953194 1185.68 0.2129 0.29154580      1.333333 0.2520018  -1.18448700　　0.538525　　過小評価
3  0.4893703 1185.68 0.2129 0.28311180      1.333333 0.2520018  -1.14381700　　0.528378　　過小評価
4  0.4821165 1185.68 0.2129 0.27467780      1.333333 0.2520018  -1.10362200　　0.5184369　 過小評価
5  0.4647647 1185.68 0.2129 0.25780990      1.333333 0.2520018  -1.02461700　　0.4990348   過小評価
6  0.4550117 1185.68 0.2129 0.24937590      1.333333 0.2520018  -0.98578500
7  0.4497813 1185.68 0.2129 0.24094190      1.333333 0.2520018  -0.94738700
8  0.3111315 1185.68 0.2129 0.08069631      1.333333 0.2520018  -0.28914990
9  0.2784119 1185.68 0.2129 0.03852642      1.333333 0.2520018  -0.13501710　　0.2811394   適切評価
10 0.2520018 1185.68 0.2129 0.00479050      1.333333 0.2520018  -0.01650251　　0.255836    適切評価

 0.2520018\*get.predicted.spline.skew(SkewModel,-1.26730000)=0.5596092

■getPositionGreeks(thePosition)
> 　Price     Delta      Gamma    Theta      Vega    UDLY 　　ThetaEffect GammaEffect DeltaEffect VegaEffect
1 1742.506 -13.63872 -0.1975418 46.43088 -89.65098 1185.68    139.2926   -76.69092   -380.0416  -281.8628

--
■createPositinEvalTable(position=thePosition,udlStepNum=udlStepNum,udlStepPct=udlStepPct,days=stepdays)$pos[[81](81.md)

> Date   ExpDate TYPE Strike        ContactName Position      Price        Delta        Gamma       Vega       Theta
> +5bdays

1  2015/01/16 2015/2/20    1    820 RUT150220P00820000        4  0.3307248 -0.005566610 8.947715e-05 0.04767702 -0.06045546
2  2015/01/16 2015/2/20    1    840 RUT150220P00840000        4  0.3847446 -0.006651820 1.093649e-04 0.05582794 -0.06780592
3  2015/01/16 2015/2/20    1    850 RUT150220P00850000       -2  0.4187167 -0.007325818 1.216158e-04 0.06079288 -0.07229546
4  2015/01/16 2015/2/20    1    860 RUT150220P00860000       -2  0.4582747 -0.008105841 1.357228e-04 0.06645530 -0.07740212
5  2015/01/16 2015/2/20    1    880 RUT150220P00880000        2  0.5562508 -0.010032325 1.704279e-04 0.08010057 -0.08953036
6  2015/01/16 2015/2/20    1    890 RUT150220P00890000        4  0.6159754 -0.011208027 1.915749e-04 0.08821826 -0.09659628
7  2015/01/16 2015/2/20    1    900 RUT150220P00900000        3  0.6839432 -0.012549110 2.156892e-04 0.09730644 -0.10436998
8  2015/01/16 2015/2/20    1   1090 RUT150220P01090000       -3  7.1466794 -0.139925466 2.301769e-03 0.66681094 -0.45640130
9  2015/01/16 2015/2/20    1   1140 RUT150220P01140000       -3 14.9451063 -0.275962013 3.948032e-03 1.00171877 -0.59736585
10 2015/01/16 2015/2/20    1   1180 RUT150220P01180000        3 27.2106877 -0.453516490 5.198631e-03 1.18748676 -0.63205249
> Rho    OrigIV    UDLY    IVIDX  HowfarOOM    TimeToExpDate  ATMIV   Moneyness.Nm  IV理論値
> > ↑に           Vconeの     不変                                少し左側に
> > > 影響。↑
1  -0.001213179 0.5932484 1185.68 0.215329 0.30841374      1.095238 0.2501501  -1.40863230    0.5932485
2  -0.001447858 0.5683466 1185.68 0.215329 0.29154578      1.095238 0.2501501  -1.31658352    0.5683466
3  -0.001593685 0.5565477 1185.68 0.215329 0.28311180      1.095238 0.2501501  -1.27137778    ..
4  -0.001762495 0.5451507 1185.68 0.215329 0.27467782      1.095238 0.2501501  -1.22670079    ..
5  -0.002179465 0.5232805 1185.68 0.215329 0.25780986      1.095238 0.2501501  -1.13888451
6  -0.002433923 0.5126956 1185.68 0.215329 0.24937589      1.095238 0.2501501  -1.09572202
7  -0.002724147 0.5022881 1185.68 0.215329 0.24094191      1.095238 0.2501501  -1.05304181
8  -0.030290949 0.3225378 1185.68 0.215329 0.08069631      1.095238 0.2501501  -0.32139655
9  -0.059888875 0.2824911 1185.68 0.215329 0.03852642      1.095238 0.2501501  -0.15007458
10 -0.098885318 0.2543194 1185.68 0.215329 0.00479050      1.095238 0.2501501  -0.01834291

■getPositionGreeks(createPositinEvalTable(position=thePosition,udlStepNum=udlStepNum,udlStepPct=udlStepPct,days=stepdays)$pos[[81](81.md)])

> Price     Delta      Gamma    Theta      Vega    UDLY ThetaEffect GammaEffect DeltaEffect VegaEffect
1 2209.283 -23.34415 -0.1118595 17.29378 -47.86119 1185.68    51.88135   -44.43523   -657.9915  -152.1925

1742.506+139.2926=1881.7986  (ThetaEffectによる価格上昇）
2209.283-2209.283= 327.4844   (Volatility TimeIncrease & Assumed Volatility Arbitrageによる価格上昇）

■考察

時間経過。
VConeの影響により、IVIDX、ATMIVともに若干上昇。
Moneyness.Nmが若干左側に。
OrigIV↑
> FOOMほど割合大きい。->絶対幅大きい
> > 絶対幅**SkewModelの傾きの影響大
> > > -> FOOM程OrigIVの増加大。**

他のパラメータが動かなくでも、VolatilityのTimeDecayならぬTimeIncrease
圧力がIVにかかっており、その影響はFOOMほど顕著に大きい。

従って、利益を大きくしながらThetaを正の値で維持しながら、tailリスク抑えて、
EachEffectの影響をフラットにしようと最適化すると、FOMのOptionのLong+Shortの
組み合わせが計算される。

さらに、IV理論値に対して、過小評価されているOptionを大きくLongして、そうでもない
OptionをShortしてバランスを取っている。その価格の歪みが1/16には解消されると仮定して
Priceを計算しているので、より大きなProfitが出ると見積もられている。

これ自体は、過大評価をされたオプションを売り、過小評価されたオプションを買うという点で
非常に強力な機能だが、必ずしもholdDaysの間にVolatilityの歪みが解消するとは限らないので、
モデルから得られるprofitをそのまま利用するには注意が必要である。むしろ、歪みを抽出する
一種のコスト関数とみなすべきでる。

特にinitial Creditが<0(initial Debtとなる時）は注意が必要である。

FOOMのVolatility Skewのモデルの当てはまり方は、多少の誤差を含みやすいし、
それがうまく行かなかった場合Volatilityが収益に与える影響は非常にsensitiveだと
考えられるので、実際にこの戦略を実行するのは充分考慮が必要である。

そういう意味で、FOOMのOptionの選択肢は初めから除外して最適化を考えるのが良いかもしれない。