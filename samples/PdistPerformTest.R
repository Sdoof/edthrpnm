library(MASS)
library(KernSmooth)
weight_IV=c(0.2740686,0.4518628,0.2740686)
weight=c(2.215836e-17,9.471649e-18,1.363345e-17,3.247789e-17,2.26364e-09,9.204629e-05,0.001706235,0.001655561,0.006460281,0.01358492,0.02029524,0.04138923,0.0785814,0.1143355,0.1932887,0.22706,0.184363,0.08649667,0.02123787,0.00609838,0.002160037,0.001190403,4.594999e-06,7.70273e-12,0,0,6.611522e-19,0,2.211419e-18)
#No.4 
profit_vector=c(-1869.213,-1862.559,-1860.855,-1865.222,-1852.14,-1786.606,-1598.819,-1227.605,-669.0555,25.76943,748.0794,1184.661,1017.718,437.947,-93.64326,-124.2989,234.8014,809.894,1422.622,2026.239,2591.104,3090.38,3493.194,3737.861,3915.626,4029.653,4105.327,4164.358,4213.498)
profit_vector_vc_plus=c(-1900.259,-1890.318,-1889.619,-1899.958,-1880.616,-1776.8,-1505.883,-1046.723,-445.1457,266.376,957.2441,1204.412,847.2702,239.618,-149.7904,13.65874,442.2614,982.8897,1506.6,2005.326,2474.688,2900.484,3309.1,3576.564,3780.688,3911.836,3996.744,4063.654,4121.026)
profit_vector_vc_minus=c(-1905.234,-1899.172,-1894.752,-1892.463,-1883.64,-1852.734,-1753.239,-1500.923,-1025.254,-350.8299,412.4693,1025.416,1085.535,590.1416,-18.36731,-174.1808,201.7405,910.0021,1680.667,2408.214,3036.206,3535.239,3871.157,4054.62,4177.033,4252.592,4302.211,4339.811,4370.13)

pdist2=profit_vector*weight*weight_IV[2]+
  profit_vector_vc_plus*weight*weight_IV[3]+
  profit_vector_vc_minus*weight*weight_IV[1]

probdist2=weight*weight_IV[2]+
  weight*weight_IV[3]+
  weight*weight_IV[1]

sum(probdist2)
sum(pdist2)
sd(pdist2)

pdist<-c(rep(rep(profit_vector,times=round(weight*100)),times=round(weight_IV*100)[2]),
         rep(rep(profit_vector_vc_plus,times=round(weight*100)),times=round(weight_IV*100)[3]),
         rep(rep(profit_vector_vc_minus,times=round(weight*100)),times=round(weight_IV*100)[1]))
mean(pdist)
sd(pdist)

pdist<-c(rep(rep(profit_vector,times=round(weight*500)),times=round(weight_IV*100)[2]),
         rep(rep(profit_vector_vc_plus,times=round(weight*500)),times=round(weight_IV*100)[3]),
         rep(rep(profit_vector_vc_minus,times=round(weight*500)),times=round(weight_IV*100)[1]))
mean(pdist)
sd(pdist)

pdist<-c(rep(rep(profit_vector,times=round(weight*1000)),times=round(weight_IV*100)[2]),
         rep(rep(profit_vector_vc_plus,times=round(weight*1000)),times=round(weight_IV*100)[3]),
         rep(rep(profit_vector_vc_minus,times=round(weight*1000)),times=round(weight_IV*100)[1]))
mean(pdist)
sd(pdist)

#No.4 
profit_vector=c(-1869.213,-1862.559,-1860.855,-1865.222,-1852.14,-1786.606,-1598.819,-1227.605,-669.0555,25.76943,748.0794,1184.661,1017.718,437.947,-93.64326,-124.2989,234.8014,809.894,1422.622,2026.239,2591.104,3090.38,3493.194,3737.861,3915.626,4029.653,4105.327,4164.358,4213.498)
profit_vector_vc_plus=c(-1900.259,-1890.318,-1889.619,-1899.958,-1880.616,-1776.8,-1505.883,-1046.723,-445.1457,266.376,957.2441,1204.412,847.2702,239.618,-149.7904,13.65874,442.2614,982.8897,1506.6,2005.326,2474.688,2900.484,3309.1,3576.564,3780.688,3911.836,3996.744,4063.654,4121.026)
profit_vector_vc_minus=c(-1905.234,-1899.172,-1894.752,-1892.463,-1883.64,-1852.734,-1753.239,-1500.923,-1025.254,-350.8299,412.4693,1025.416,1085.535,590.1416,-18.36731,-174.1808,201.7405,910.0021,1680.667,2408.214,3036.206,3535.239,3871.157,4054.62,4177.033,4252.592,4302.211,4339.811,4370.13)

#No.3
profit_vector=c(852.0989,856.9443,861.5835,865.8584,870.0113,872.4378,866.281,853.5825,856.3285,928.3567,1089.037,1186.046,966.8534,330.88,-411.272,-443.4971,319.2535,1590.179,2953.399,4305.254,5580.533,6683.581,7552.303,8075.589,8460.441,8713.101,8885.56,9020.414,9130.536)
profit_vector_vc_plus=c(820.8675,827.0066,832.0263,835.3986,837.2717,834.4825,814.9027,782.5259,777.1326,882.0707,1070.708,1102.691,773.1784,88.29296,-497.6255,-228.7325,641.846,1833.644,3007.702,4145.702,5239.185,6199.926,7087.207,7661.136,8102.865,8395.471,8594.723,8754.24,8887.846)
profit_vector_vc_minus=c(815.4497,820.8137,826.2145,831.6564,837.3157,842.7851,845.789,847.2175,855.7242,897.6032,1010.198,1136.376,1036.888,542.5892,-177.4695,-323.6344,513.4487,2047.604,3712.372,5285.48,6646.968,7713.741,8424.009,8811.21,9072.189,9235.01,9342.806,9423.995,9488.498)

#No.16
profit_vector=c(-2178.098,-2171.147,-2168.707,-2172.442,-2164.839,-2110.597,-1915.537,-1461.957,-712.8025,148.6569,816.1829,1106.508,1022.615,560.366,-170.44,-407.2971,146.2769,1332.336,2679.961,4057.917,5377.105,6510.954,7400.86,7947.354,8352.335,8620.405,8803.575,8945.332,9060.067)

profit_vector_vc_plus=c(-2215.664,-2206.427,-2206.091,-2217.606,-2210.968,-2130.85,-1852.181,-1263.389,-410.8406,409.018,936.2544,1076.751,858.5934,307.2871,-349.2524,-326.9905,359.9419,1499.382,2675.511,3851.023,4995.752,5981.398,6884.112,7488.226,7957.576,8271.473,8485.161,8653.362,8792.212)

profit_vector_vc_minus=c(-2210.703,-2204.392,-2199.504,-2196.669,-2189.331,-2161.877,-2058.679,-1770.219,-1187.598,-360.9243,416.911,872.5284,979.0205,738.3629,159.4809,-99.54255,525.1931,1944.079,3569.548,5147.474,6532.86,7618.333,8341.248,8739.849,9009.914,9179.258,9291.401,9375.354,9441.703)

### NO.2
#2 No.8
profit_vector=c(48.06614,53.03556,57.90432,62.5797,67.04528,71.52348,71.91779,63.00788,55.91676,84.46057,219.2764,447.3793,558.8021,346.4181,-85.2721,-229.2596,126.3687,912.8927,1824.117,2752.644,3646.588,4428.454,5039.466,5441.825,5739.243,5925.307,6050.21,6148.579,6229.417)
profit_vector_vc_plus=c(14.86659,21.89576,28.23953,33.562,37.632,40.6176,35.09297,12.17072,-8.184181,33.27833,228.658,480.1399,519.7138,235.0217,-149.6173,-113.1921,345.247,1110.153,1906.951,2688.629,3447.863,4116.892,4719.302,5158.92,5500.57,5713.405,5854.82,5969.25,6066.032)
profit_vector_vc_minus=c(11.94181,17.28801,22.67234,28.1006,33.62595,39.42299,44.18955,46.15591,49.52639,68.36256,144.4837,317.6712,472.5197,364.5814,-7.461142,-185.7538,213.1554,1168.543,2293.651,3394.775,4372.184,5150.068,5669.406,5971.34,6174.642,6296.966,6377.233,6437.981,6486.378)

#2 No.11
profit_vector=c(-2135.258,-2129.226,-2130.214,-2132.78,-2109.452,-2005.093,-1741.32,-1254.631,-558.2268,227.9626,903.4017,1165.102,959.7224,454.7455,-68.5466,-151.3647,166.2923,705.1461,1286.31,1863.769,2403.753,2881.08,3272.979,3501.673,3668.578,3777.528,3849.793,3906.554,3954.187)
profit_vector_vc_plus=c(-2168.858,-2160.242,-2164.493,-2171.956,-2135.844,-1973.63,-1607.393,-1024.306,-282.5237,477.2359,1031.863,1121.267,788.3711,257.0053,-145.8753,-44.95247,344.8246,855.1852,1353.89,1834.067,2285.071,2691.838,3095.369,3346.691,3537.872,3662.72,3743.21,3807.352,3863.132)
profit_vector_vc_minus=c(-2170.518,-2164.619,-2161.119,-2158.123,-2145.18,-2095.773,-1946.883,-1597.02,-985.7151,-182.8184,620.9885,1083.717,1042.018,616.8428,49.82725,-144.2245,182.275,839.0815,1562.595,2249.869,2843.277,3315.777,3636.732,3807.382,3922.415,3994.56,4042.016,4078.193,4107.552)

pdist<-c(rep(rep(profit_vector,times=round(weight*5000)),times=round(weight_IV*100)[2]),
         rep(rep(profit_vector_vc_plus,times=round(weight*5000)),times=round(weight_IV*100)[3]),
         rep(rep(profit_vector_vc_minus,times=round(weight*5000)),times=round(weight_IV*100)[1]))
mean(pdist)
mean(pdist[pdist<0])
mean((pdist<0)*pdist)
mean((pdist>=0)*pdist)
sd(pdist)
sd(pdist[pdist<0])
sd((pdist<0)*pdist)
sd((pdist>=0)*pdist)
length(pdist[pdist<0])/length(pdist)

hist(pdist)
h <- dpih(pdist)
bins <- seq(min(pdist)-3*h/2, max(pdist)+3*h/2, by=h)
hist(pdist, breaks=bins)

hist((pdist<0)*pdist)
h <- dpih((pdist<0)*pdist)
bins <- seq(min((pdist<0)*pdist)-3*h/2, max(pdist)+3*h/2, by=h)
hist((pdist<0)*pdist, breaks=bins)

pdist<-c(rep(rep(profit_vector,times=round(weight*50000)),times=round(weight_IV*100)[2]),
         rep(rep(profit_vector_vc_plus,times=round(weight*500000)),times=round(weight_IV*100)[3]),
         rep(rep(profit_vector_vc_minus,times=round(weight*5000)),times=round(weight_IV*100)[1]))
mean(pdist)
sd(pdist)

start_t<-proc.time()  
for(i in 1:1000){
  pdist<-c(rep(rep(profit_vector,times=round(weight*500)),times=round(weight_IV*100)[2]),
           rep(rep(profit_vector_vc_plus,times=round(weight*500)),times=round(weight_IV*100)[3]),
           rep(rep(profit_vector_vc_minus,times=round(weight*500)),times=round(weight_IV*100)[1]))
  mean(pdist)
  sd(pdist)
}
cat(" time: ",(proc.time()-start_t)[3])


start_t<-proc.time()  
for(i in 1:1000){
  pdist<-c(rep(rep(profit_vector,times=round(weight*1000)),times=round(weight_IV*100)[2]),
           rep(rep(profit_vector_vc_plus,times=round(weight*1000)),times=round(weight_IV*100)[3]),
           rep(rep(profit_vector_vc_minus,times=round(weight*1000)),times=round(weight_IV*100)[1]))
  mean(pdist)
  sd(pdist)
}
cat(" time: ",(proc.time()-start_t)[3])

start_t<-proc.time()  
for(i in 1:1000){
  pdist<-c(rep(rep(profit_vector,times=round(weight*5000)),times=round(weight_IV*100)[2]),
           rep(rep(profit_vector_vc_plus,times=round(weight*5000)),times=round(weight_IV*100)[3]),
           rep(rep(profit_vector_vc_minus,times=round(weight*5000)),times=round(weight_IV*100)[1]))
  mean(pdist)
  sd(pdist)
}
cat(" time: ",(proc.time()-start_t)[3])

start_t<-proc.time()  
for(i in 1:1000){
  pdist<-c(rep(rep(profit_vector,times=round(weight*50000)),times=round(weight_IV*100)[2]),
           rep(rep(profit_vector_vc_plus,times=round(weight*50000)),times=round(weight_IV*100)[3]),
           rep(rep(profit_vector_vc_minus,times=round(weight*50000)),times=round(weight_IV*100)[1]))
  mean(pdist)
  sd(pdist)
}
cat(" time: ",(proc.time()-start_t)[3])


